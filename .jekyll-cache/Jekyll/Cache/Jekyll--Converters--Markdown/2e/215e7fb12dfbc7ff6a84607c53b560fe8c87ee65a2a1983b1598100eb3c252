I"ÿ <p>This post describes how to deploy absolutely free bugtracker - <strong>Redmine</strong> to free hosting <strong>Heroku</strong>. Thatâ€™s way you will have free bugtracker in the internet. There are many post in the internet that describe how to deploy old version of <strong>Redmine</strong> to <strong>Heroku</strong>, but I couldnâ€™t find any information how to deploy new version of <strong>Redmine</strong>: <strong>Redmine 2</strong>. So if you have the same problem - you are welcome</p>

<h2 id="changes-for-heroku">Changes for Heroku</h2>

<blockquote>
  <p>NOTE: This manual is actual only for Redmine 2.2.2 version. There are a lot of changes in next release which will be I think 2.2.3.</p>
</blockquote>

<p>So letâ€™s go! Firstly we need to clone sources from <strong>github</strong>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget https://github.com/edavis10/redmine/archive/2.2.2.tar.gz
tar -zxvf 2.2.2.tar.gz
cd redmine-2.2.2
git init .
</code></pre></div></div>

<p>Open <em>.gitignore</em> file in your favourite editor and remove lines:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Gemfile.lock
Gemfile.local
public/plugin_assets
config/initializers/session_store.rb
config/initializers/secret_token.rb
config/configuration.yml
config/email.yml
</code></pre></div></div>

<p>Install gems:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bundle install
</code></pre></div></div>

<p>Execute rake task to generate session token:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rake generate_secret_token
</code></pre></div></div>

<p>Create application on the heroku:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>heroku create NAME_FOR_YOUR_APP
</code></pre></div></div>

<p>Make commit and push changes to heroku origin:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git add -A
git commit -m "prepare for heroku"
git push heroku
</code></pre></div></div>

<p>Make sure that all gems was installed on the heroku server and after this run migrations there with loading default data for properly working Redmine:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>heroku run rake db:migrate
heroku run rake redmine:load_default_data
</code></pre></div></div>

<p>Thatâ€™s all, you can test it now in the browser:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>heroku open
</code></pre></div></div>

<p>Default user for Redmine is <strong>admin</strong> and password is <strong>admin</strong> too.</p>

<h2 id="email-confirmations">Email confirmations</h2>

<p>Firstly add add-on on the heroku for your application:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>heroku addons:add sendgrid:starter
</code></pre></div></div>

<p>There is a limitation for free version of this add-on: <em>200 emails per day</em>. So if you have more emails for one day you have to change plan of add-on to more appropriate. For more information, please, read <a href="https://addons.heroku.com/sendgrid">add-on desription</a>.</p>

<p>Create <em>config/configuration.yml</em> file and add there the following changes and change user_name and password to yours:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="ss">production:
  delivery_method: :smtp</span>
  <span class="ss">smtp_settings:
    address: </span><span class="s2">"smtp.sendgrid.net"</span>
    <span class="ss">port: </span><span class="mi">25</span>
    <span class="ss">authentication: :plain</span>
    <span class="ss">domain: </span><span class="s2">"heroku.com"</span>
    <span class="ss">user_name: </span><span class="s2">"SENDGRID_USERNAME"</span>
    <span class="ss">password: </span><span class="s2">"SENDGRID_PASSWORD"</span></code></pre></figure>

<p>Push changes to the heroku:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git add -A
git commit -m "email configuration"
gut push heroku
</code></pre></div></div>

<h2 id="save-uploaded-files-to-amazon-s3">Save uploaded files to Amazon S3</h2>

<p>If you are going to add attachment to tasks or just upload files to redmine you can setup <strong>redmine_s3</strong> plugin: <a href="http://github.com/ka8725/redmine_s3.git">http://github.com/ka8725/redmine_s3.git</a>. Please follow link to read instrunctions how to install it. This is my fork of original gem: <strong>git://github.com/tigrish/redmine_s3.git</strong></p>

<blockquote>
  <p>Since <strong>Redmine 2</strong> has released there are many changes there and gem <strong>git://github.com/tigrish/redmine_s3.git</strong> is not working with it now. Thatâ€™s why I forked this gem and have changed it.</p>
</blockquote>

<blockquote>
  <p>Donâ€™t forget to remove directory <strong>plugins/redmine_s3/.git</strong> before make commit. This plugin wonâ€™t be install on the <strong>Heroku</strong> otherwise and you wonâ€™t be able to save files to <strong>s3</strong>.</p>
</blockquote>

<p>Create configuration file for <em>redmine_s3</em> gem:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cp plugins/redmine_s3/config/s3.yml.example config/s3.yml
</code></pre></div></div>

<p>Edit <em>config/s3.yml</em> with your favourite editor: paste there your credentials (security keys) for AWS S3 and bucket name. Bucket should be already created on the S3.</p>

<p>Push changes to the heroku:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git add -A
git commit -m "s3 configuration"
gut push heroku
</code></pre></div></div>

<p>To start server on the heroku you should also remove or comment out this code in <em>config/environment.rb</em>:</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># Make sure there's no plugin in vendor/plugin before starting</span>
<span class="n">vendor_plugins_dir</span> <span class="o">=</span> <span class="no">File</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="no">Rails</span><span class="p">.</span><span class="nf">root</span><span class="p">,</span> <span class="s2">"vendor"</span><span class="p">,</span> <span class="s2">"plugins"</span><span class="p">)</span>
<span class="k">if</span> <span class="no">Dir</span><span class="p">.</span><span class="nf">glob</span><span class="p">(</span><span class="no">File</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">vendor_plugins_dir</span><span class="p">,</span> <span class="s2">"*"</span><span class="p">)).</span><span class="nf">any?</span>
  <span class="vg">$stderr</span><span class="p">.</span><span class="nf">puts</span> <span class="s2">"Plugins in vendor/plugins (</span><span class="si">#{</span><span class="n">vendor_plugins_dir</span><span class="si">}</span><span class="s2">) are no longer allowed. "</span> <span class="o">+</span>
    <span class="s2">"Please, put your Redmine plugins in the `plugins` directory at the root of your "</span> <span class="o">+</span>
    <span class="s2">"Redmine directory (</span><span class="si">#{</span><span class="no">File</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="no">Rails</span><span class="p">.</span><span class="nf">root</span><span class="p">,</span> <span class="s2">"plugins"</span><span class="p">)</span><span class="si">}</span><span class="s2">)"</span>
  <span class="nb">exit</span> <span class="mi">1</span>
<span class="k">end</span></code></pre></figure>

<p>Thatâ€™s it - you have free bugtracker on the internet. Check it out: <a href="http://redmine-todo.heroku.com">http://redmine-todo.heroku.com</a>.</p>

<h2 id="conclusion">Conclusion</h2>

<p>Bundle with <strong>Redmine</strong> and <strong>Heroku</strong> perfectly appropriate for developers who wanted to save money and have a good bugtracker. But if your project is opensource and there is no matter to hide your project in the internet you can use <a href="http://www.hostedredmine.com/">free hosted redmine</a> or <a href="https://www.pivotaltracker.com">Pivotal Tracker</a>.</p>
:ET